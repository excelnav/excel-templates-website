{{/*
  统一的模板卡片组件
  参数:
  - .template: 模板页面对象
  - .showCategory: 是否显示分类标签 (可选)
  - .showDescription: 是否显示描述 (可选)
  - .cardSize: 卡片尺寸 "small", "medium", "large" (默认: "medium")
*/}}

{{ $template := .template }}
{{ $showCategory := default false .showCategory }}
{{ $showDescription := default false .showDescription }}
{{ $cardSize := default "medium" .cardSize }}

<article class="template-card template-card--{{ $cardSize }}" 
         data-category="{{ if $template.Params.categories }}{{ delimit $template.Params.categories "," }}{{ end }}"
         data-title="{{ $template.Title }}"
         data-date="{{ $template.Date.Format "2006-01-02" }}"
         data-tags="{{ if $template.Params.tags }}{{ delimit $template.Params.tags "," }}{{ end }}">
    
    <!-- 模板图片区域 -->
    <div class="template-card__image">
        {{ if $template.Params.featured_image }}
            <img src="{{ $template.Params.featured_image }}" 
                 alt="{{ $template.Title }} ​Thumbnail​ " 
                 loading="lazy"
                 class="template-card__img">
        {{ else }}
            <!-- 占位符图片 -->
            <div class="template-card__placeholder">
                <svg class="template-card__icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="16" y1="13" x2="8" y2="13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <line x1="16" y1="17" x2="8" y2="17" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    <polyline points="10,9 9,9 8,9" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                </svg>
                <span class="template-card__placeholder-text">Excel template</span>
            </div>
        {{ end }}
        
        <!-- 悬停覆盖层 -->
        <div class="template-card__overlay">
            <div class="template-card__overlay-content">
                <a href="{{ $template.Permalink }}" class="template-card__view-btn">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    View
                </a>
            </div>
        </div>

        <!-- 分类标签 (可选) -->
        {{ if and $showCategory $template.Params.categories }}
            <div class="template-card__category">
                {{ range first 1 $template.Params.categories }}
                    <span class="template-card__category-tag">{{ . }}</span>
                {{ end }}
            </div>
        {{ end }}
    </div>

    <!-- 模板内容区域 -->
    <div class="template-card__content">
        <!-- 标题 -->
        <div class="template-card__header">
            <h3 class="template-card__title">
                <a href="{{ $template.Permalink }}" class="template-card__title-link">
                    {{ $template.Title }}
                </a>
            </h3>
        </div>

        <!-- 描述 (可选) -->
        {{ if $showDescription }}
            <div class="template-card__description">
                <p>{{ $template.Summary | truncate 80 }}</p>
            </div>
        {{ end }}

        <!-- 元信息 -->
        <div class="template-card__meta">
            {{ if $template.Params.file_size }}
                <span class="template-card__meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" stroke="currentColor" stroke-width="2"/>
                        <polyline points="14,2 14,8 20,8" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    {{ $template.Params.file_size }}
                </span>
            {{ end }}
            
            {{ if $template.Params.excel_version }}
                <span class="template-card__meta-item">
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <rect x="2" y="3" width="20" height="14" rx="2" ry="2" stroke="currentColor" stroke-width="2"/>
                        <line x1="8" y1="21" x2="16" y2="21" stroke="currentColor" stroke-width="2"/>
                        <line x1="12" y1="17" x2="12" y2="21" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    {{ $template.Params.excel_version }}
                </span>
            {{ end }}
        </div>

        <!-- 操作按钮 -->
        <div class="template-card__actions">
            {{ if $template.Params.download_url }}
                <a href="{{ $template.Params.download_url }}" class="template-card__primary-btn" download>
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4M7 10l5 5 5-5M12 15V3" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                    </svg>
                    Download Now
                </a>
            {{ else }}
                <a href="{{ $template.Permalink }}" class="template-card__primary-btn">
                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" stroke="currentColor" stroke-width="2"/>
                        <circle cx="12" cy="12" r="3" stroke="currentColor" stroke-width="2"/>
                    </svg>
                    View
                </a>
            {{ end }}
        </div>
    </div>
</article>